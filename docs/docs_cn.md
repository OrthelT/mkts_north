# 冬季联盟市场统计查看器 - 用户指南

## 介绍
冬季联盟市场统计查看器是一个 Streamlit 应用，为 EVE Online 物品提供近实时的市场数据分析，特别针对冬季联盟。该工具有助于监控市场状况、跟踪价格、分析库存水平，以及监控舰队配装的市场可用性。对于 Chrome 用户，您可以通过点击安装 Streamlit 图标，在本地机器上以独立应用的方式运行此工具。

**应用程序 URL：** https://wcmkts.streamlit.app/

**支持：** 此应用由 Orthel Toralen 开发，他对自己所做的事情只有模糊的了解。如需支持或报告问题，请访问我的开发者 Discord：OrthelsLab：https://discord.gg/87Tb7YP5

**如何贡献：** WCMkts 是一个使用 Python 3.12 编写，并在 MIT 许可证下提供的开源项目。源代码托管在 GitHub：https://github.com/OrthelT/wcmkts_new，欢迎任何形式的贡献。

**注意：** 本应用设计为深色模式。在右上角点击“汉堡”菜单，选择“设置” -> “选择应用主题、颜色和字体” -> “深色”。

**更新频率：** 虽然不是完全实时，数据每隔几小时刷新一次，而完整的市场历史数据则在每天大约 EVE 时间13:00 更新。这样做可以获得非常快的性能，因为我们在其他地方处理对 Eve ESI 的调用和数据处理。该应用仅使用本地 SQLite 数据库，并定期与远程主数据库同步以生成数据展示。在市场统计页面点击“立即同步”按钮，可更新到最新数据。

# 页面和功能

### 1. 市场统计页面
![市场统计](images/wclogo.png)

**目的：** 提供 4-HWWF 市场的当前卖单的详细市场信息。包括超过800种常用物品和舰船的历史数据，对冬季联盟教条物品提供更详细的数据。

当前主 DataFrame 显示所有已选择的物品。目前仅显示卖单，若有需求可后续添加买单。

**主要功能：**
- **物品选择：** 通过侧边栏过滤器按类别和特定物品进行筛选
- **数据导出：** 点击每个表格顶部的下载图标，可将当前视图导出为 .csv 文件，用于您自己的电子表格。勾选“显示所有数据”可确保下载完整数据。
- **市场指标：** 查看最低卖价、当前库存水平和库存天数
- **价格分布图：** 以可视化形式展示不同价格区间的市场挂单情况
- **价格历史图：** 跟踪过去30天的价格和交易量趋势
- **配装信息：** 对于冬季联盟教条舰船，查看该配装所需物品的市场信息

**使用方法：**
1. 使用侧边栏过滤器选择类别和/或具体物品  
2. 在页面顶部查看市场指标  
3. 检查价格分布图，以了解当前市场状况  
4. 查看价格历史图，了解过去30天的趋势  
5. 对于舰船，查看配装信息  

### 2. 库存不足页面
**目的：** 识别市场上库存不足的物品，帮助优先考虑补货。

**主要功能：**
- **剩余天数过滤：** 设置最大库存剩余天数以筛选
- **教条物品过滤：** 仅关注教条配装中的关键物品
- **类别过滤：** 按物品类别筛选
- **关键物品高亮：** 以颜色区分紧急（红色）和低库存（橙色）
- **可视化图表：** 显示各物品剩余天数的柱状图

**使用方法：**
1. 调整“最大剩余天数”滑块，以关注低于某个阈值的物品  
2. 勾选“仅显示教条物品”，聚焦关键组件  
3. 选择类别以缩小结果范围  
4. 查看关键物品（≤3天）和低库存物品（3-7天）的指标  
5. 查看详细表格，判断库存水平和预计剩余天数  
6. 在“已用于配装”列查看该物品在哪些教条舰船中使用  

### 3. 教条状态页面
**目的：** 监控教条舰船及其组件的可用性。

**主要功能：**
- **教条分组：** 按舰船类别（如巡洋舰、护卫舰）组织  
- **状态指示：** 以颜色徽章显示（绿色：正常，橙色：需关注，红色：紧急）  
- **进度条：** 可视化当前库存与目标的对比  
- **低库存模块跟踪：** 识别限制可用配装的模块  
- **导出功能：** 生成购物清单 CSV 或复制到剪贴板  
- **高级过滤：** 按舰船状态、舰船组和模块库存级别筛选  
- **批量选择：** 支持全选/取消全选舰船或模块  

**使用方法：**
1. 使用侧边栏过滤器，聚焦特定教条状态、舰船组或模块库存  
2. 按教条组浏览舰船  
3. 查看进度条，判断库存是否达到目标  
4. 检查红色（紧急）或橙色（低库存）标记的模块  
5. 勾选所需舰船和模块  
6. 使用“全选舰船/模块”按钮快速操作  
7. 点击“下载 CSV”导出所选内容  
8. 使用“复制到剪贴板”将所选内容复制  

## 数据库同步
应用每天在 13:00 UTC 自动与远程 EVE Online 市场数据库同步。您也可以在侧边栏点击“立即同步”手动触发同步。如有新数据，将自动更新。

**同步状态指示：**
- 上次 ESI 更新：显示从 ESI 获取市场数据的时间  
- 上次同步：显示本地数据库最后一次与远程数据库同步的时间  
- 下次计划同步：显示下一次自动同步的时间  
- 状态：显示最近一次同步的成功或失败  

## 提示和最佳实践

### 用于市场分析
- 检查“剩余天数”指标，识别需要立即补货的物品  
- 使用价格历史图，识别价格变化趋势  
- 将库存与“市场可配装”对比，判断库存是否充足  

### 用于教条管理
- 关注教条状态页面中标记为“紧急”的舰船  
- 重点查看“低库存模块”部分，识别瓶颈  
- 使用导出功能生成补货清单  

### 性能提示
- 本应用采用 Turso Cloud 的嵌入式副本功能，实现本地嵌入式 SQLite 数据库的高性能运行，基于 libSQL（SQLite 的 Rust 高性能分支）。  
- 应用会对数据进行缓存，以提高性能  
- 同步操作定时执行，耗时仅几秒  
- 大量数据查询采用批处理方式，防止超时  

## 故障排除
- 如果应用无法正常工作，很可能是您的开发者不小心搞砸了。请随时在 Discord 上 DM 我，我会尽力解决。Discord: orthel_toralen

## 支持和反馈
如有问题或功能需求，请联系维护者：  
- 邮件：orthel.toralen@gmail.com  
- Discord: orthel_toralen
